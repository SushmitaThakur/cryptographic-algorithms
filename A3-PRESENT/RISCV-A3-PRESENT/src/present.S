.section .text
.global present

present:

.data

sp_3:
.byte   0xF0, 0xB1, 0xB4, 0xE5, 0xE1, 0xA0, 0xE4, 0xF1, 0xA5, 0xF4, 0xF5, 0xE0, 0xB0, 0xB5, 0xA1, 0xA4 
.byte   0x72, 0x33, 0x36, 0x67, 0x63, 0x22, 0x66, 0x73, 0x27, 0x76, 0x77, 0x62, 0x32, 0x37, 0x23, 0x26 
.byte   0x78, 0x39, 0x3C, 0x6D, 0x69, 0x28, 0x6C, 0x79, 0x2D, 0x7C, 0x7D, 0x68, 0x38, 0x3D, 0x29, 0x2C 
.byte   0xDA, 0x9B, 0x9E, 0xCF, 0xCB, 0x8A, 0xCE, 0xDB, 0x8F, 0xDE, 0xDF, 0xCA, 0x9A, 0x9F, 0x8B, 0x8E 
.byte   0xD2, 0x93, 0x96, 0xC7, 0xC3, 0x82, 0xC6, 0xD3, 0x87, 0xD6, 0xD7, 0xC2, 0x92, 0x97, 0x83, 0x86 
.byte   0x50, 0x11, 0x14, 0x45, 0x41, 0x00, 0x44, 0x51, 0x05, 0x54, 0x55, 0x40, 0x10, 0x15, 0x01, 0x04 
.byte   0xD8, 0x99, 0x9C, 0xCD, 0xC9, 0x88, 0xCC, 0xD9, 0x8D, 0xDC, 0xDD, 0xC8, 0x98, 0x9D, 0x89, 0x8C 
.byte   0xF2, 0xB3, 0xB6, 0xE7, 0xE3, 0xA2, 0xE6, 0xF3, 0xA7, 0xF6, 0xF7, 0xE2, 0xB2, 0xB7, 0xA3, 0xA6 
.byte   0x5A, 0x1B, 0x1E, 0x4F, 0x4B, 0x0A, 0x4E, 0x5B, 0x0F, 0x5E, 0x5F, 0x4A, 0x1A, 0x1F, 0x0B, 0x0E 
.byte   0xF8, 0xB9, 0xBC, 0xED, 0xE9, 0xA8, 0xEC, 0xF9, 0xAD, 0xFC, 0xFD, 0xE8, 0xB8, 0xBD, 0xA9, 0xAC 
.byte   0xFA, 0xBB, 0xBE, 0xEF, 0xEB, 0xAA, 0xEE, 0xFB, 0xAF, 0xFE, 0xFF, 0xEA, 0xBA, 0xBF, 0xAB, 0xAE 
.byte   0xD0, 0x91, 0x94, 0xC5, 0xC1, 0x80, 0xC4, 0xD1, 0x85, 0xD4, 0xD5, 0xC0, 0x90, 0x95, 0x81, 0x84 
.byte   0x70, 0x31, 0x34, 0x65, 0x61, 0x20, 0x64, 0x71, 0x25, 0x74, 0x75, 0x60, 0x30, 0x35, 0x21, 0x24 
.byte   0x7A, 0x3B, 0x3E, 0x6F, 0x6B, 0x2A, 0x6E, 0x7B, 0x2F, 0x7E, 0x7F, 0x6A, 0x3A, 0x3F, 0x2B, 0x2E 
.byte   0x52, 0x13, 0x16, 0x47, 0x43, 0x02, 0x46, 0x53, 0x07, 0x56, 0x57, 0x42, 0x12, 0x17, 0x03, 0x06 
.byte   0x58, 0x19, 0x1C, 0x4D, 0x49, 0x08, 0x4C, 0x59, 0x0D, 0x5C, 0x5D, 0x48, 0x18, 0x1D, 0x09, 0x0C

sp_2:
.byte   0x3C, 0x6C, 0x2D, 0x79, 0x78, 0x28, 0x39, 0x7C, 0x69, 0x3D, 0x7D, 0x38, 0x2C, 0x6D, 0x68, 0x29 
.byte	0x9C, 0xCC, 0x8D, 0xD9, 0xD8, 0x88, 0x99, 0xDC, 0xC9, 0x9D, 0xDD, 0x98, 0x8C, 0xCD, 0xC8, 0x89 
.byte	0x1E, 0x4E, 0x0F, 0x5B, 0x5A, 0x0A, 0x1B, 0x5E, 0x4B, 0x1F, 0x5F, 0x1A, 0x0E, 0x4F, 0x4A, 0x0B 
.byte	0xB6, 0xE6, 0xA7, 0xF3, 0xF2, 0xA2, 0xB3, 0xF6, 0xE3, 0xB7, 0xF7, 0xB2, 0xA6, 0xE7, 0xE2, 0xA3 
.byte	0xB4, 0xE4, 0xA5, 0xF1, 0xF0, 0xA0, 0xB1, 0xF4, 0xE1, 0xB5, 0xF5, 0xB0, 0xA4, 0xE5, 0xE0, 0xA1 
.byte	0x14, 0x44, 0x05, 0x51, 0x50, 0x00, 0x11, 0x54, 0x41, 0x15, 0x55, 0x10, 0x04, 0x45, 0x40, 0x01 
.byte	0x36, 0x66, 0x27, 0x73, 0x72, 0x22, 0x33, 0x76, 0x63, 0x37, 0x77, 0x32, 0x26, 0x67, 0x62, 0x23 
.byte	0xBC, 0xEC, 0xAD, 0xF9, 0xF8, 0xA8, 0xB9, 0xFC, 0xE9, 0xBD, 0xFD, 0xB8, 0xAC, 0xED, 0xE8, 0xA9 
.byte	0x96, 0xC6, 0x87, 0xD3, 0xD2, 0x82, 0x93, 0xD6, 0xC3, 0x97, 0xD7, 0x92, 0x86, 0xC7, 0xC2, 0x83 
.byte	0x3E, 0x6E, 0x2F, 0x7B, 0x7A, 0x2A, 0x3B, 0x7E, 0x6B, 0x3F, 0x7F, 0x3A, 0x2E, 0x6F, 0x6A, 0x2B 
.byte	0xBE, 0xEE, 0xAF, 0xFB, 0xFA, 0xAA, 0xBB, 0xFE, 0xEB, 0xBF, 0xFF, 0xBA, 0xAE, 0xEF, 0xEA, 0xAB 
.byte	0x34, 0x64, 0x25, 0x71, 0x70, 0x20, 0x31, 0x74, 0x61, 0x35, 0x75, 0x30, 0x24, 0x65, 0x60, 0x21 
.byte	0x1C, 0x4C, 0x0D, 0x59, 0x58, 0x08, 0x19, 0x5C, 0x49, 0x1D, 0x5D, 0x18, 0x0C, 0x4D, 0x48, 0x09 
.byte	0x9E, 0xCE, 0x8F, 0xDB, 0xDA, 0x8A, 0x9B, 0xDE, 0xCB, 0x9F, 0xDF, 0x9A, 0x8E, 0xCF, 0xCA, 0x8B 
.byte   0x94, 0xC4, 0x85, 0xD1, 0xD0, 0x80, 0x91, 0xD4, 0xC1, 0x95, 0xD5, 0x90, 0x84, 0xC5, 0xC0, 0x81 
.byte   0x16, 0x46, 0x07, 0x53, 0x52, 0x02, 0x13, 0x56, 0x43, 0x17, 0x57, 0x12, 0x06, 0x47, 0x42, 0x03

sp_1:
.byte   0x0F, 0x1B, 0x4B, 0x5E, 0x1E, 0x0A, 0x4E, 0x1F, 0x5A, 0x4F, 0x5F, 0x0E, 0x0B, 0x5B, 0x1A, 0x4A 
.byte	0x27, 0x33, 0x63, 0x76, 0x36, 0x22, 0x66, 0x37, 0x72, 0x67, 0x77, 0x26, 0x23, 0x73, 0x32, 0x62 
.byte	0x87, 0x93, 0xC3, 0xD6, 0x96, 0x82, 0xC6, 0x97, 0xD2, 0xC7, 0xD7, 0x86, 0x83, 0xD3, 0x92, 0xC2 
.byte	0xAD, 0xB9, 0xE9, 0xFC, 0xBC, 0xA8, 0xEC, 0xBD, 0xF8, 0xED, 0xFD, 0xAC, 0xA9, 0xF9, 0xB8, 0xE8 
.byte	0x2D, 0x39, 0x69, 0x7C, 0x3C, 0x28, 0x6C, 0x3D, 0x78, 0x6D, 0x7D, 0x2C, 0x29, 0x79, 0x38, 0x68 
.byte	0x05, 0x11, 0x41, 0x54, 0x14, 0x00, 0x44, 0x15, 0x50, 0x45, 0x55, 0x04, 0x01, 0x51, 0x10, 0x40 
.byte	0x8D, 0x99, 0xC9, 0xDC, 0x9C, 0x88, 0xCC, 0x9D, 0xD8, 0xCD, 0xDD, 0x8C, 0x89, 0xD9, 0x98, 0xC8 
.byte	0x2F, 0x3B, 0x6B, 0x7E, 0x3E, 0x2A, 0x6E, 0x3F, 0x7A, 0x6F, 0x7F, 0x2E, 0x2B, 0x7B, 0x3A, 0x6A 
.byte	0xA5, 0xB1, 0xE1, 0xF4, 0xB4, 0xA0, 0xE4, 0xB5, 0xF0, 0xE5, 0xF5, 0xA4, 0xA1, 0xF1, 0xB0, 0xE0 
.byte	0x8F, 0x9B, 0xCB, 0xDE, 0x9E, 0x8A, 0xCE, 0x9F, 0xDA, 0xCF, 0xDF, 0x8E, 0x8B, 0xDB, 0x9A, 0xCA 
.byte	0xAF, 0xBB, 0xEB, 0xFE, 0xBE, 0xAA, 0xEE, 0xBF, 0xFA, 0xEF, 0xFF, 0xAE, 0xAB, 0xFB, 0xBA, 0xEA 
.byte	0x0D, 0x19, 0x49, 0x5C, 0x1C, 0x08, 0x4C, 0x1D, 0x58, 0x4D, 0x5D, 0x0C, 0x09, 0x59, 0x18, 0x48 
.byte	0x07, 0x13, 0x43, 0x56, 0x16, 0x02, 0x46, 0x17, 0x52, 0x47, 0x57, 0x06, 0x03, 0x53, 0x12, 0x42 
.byte	0xA7, 0xB3, 0xE3, 0xF6, 0xB6, 0xA2, 0xE6, 0xB7, 0xF2, 0xE7, 0xF7, 0xA6, 0xA3, 0xF3, 0xB2, 0xE2 
.byte	0x25, 0x31, 0x61, 0x74, 0x34, 0x20, 0x64, 0x35, 0x70, 0x65, 0x75, 0x24, 0x21, 0x71, 0x30, 0x60 
.byte	0x85, 0x91, 0xC1, 0xD4, 0x94, 0x80, 0xC4, 0x95, 0xD0, 0xC5, 0xD5, 0x84, 0x81, 0xD1, 0x90, 0xC0

sp_0:
.byte   0xC3, 0xC6, 0xD2, 0x97, 0x87, 0x82, 0x93, 0xC7, 0x96, 0xD3, 0xD7, 0x83, 0xC2, 0xD6, 0x86, 0x92 
.byte	0xC9, 0xCC, 0xD8, 0x9D, 0x8D, 0x88, 0x99, 0xCD, 0x9C, 0xD9, 0xDD, 0x89, 0xC8, 0xDC, 0x8C, 0x98 
.byte	0xE1, 0xE4, 0xF0, 0xB5, 0xA5, 0xA0, 0xB1, 0xE5, 0xB4, 0xF1, 0xF5, 0xA1, 0xE0, 0xF4, 0xA4, 0xB0 
.byte	0x6B, 0x6E, 0x7A, 0x3F, 0x2F, 0x2A, 0x3B, 0x6F, 0x3E, 0x7B, 0x7F, 0x2B, 0x6A, 0x7E, 0x2E, 0x3A 
.byte	0x4B, 0x4E, 0x5A, 0x1F, 0x0F, 0x0A, 0x1B, 0x4F, 0x1E, 0x5B, 0x5F, 0x0B, 0x4A, 0x5E, 0x0E, 0x1A 
.byte	0x41, 0x44, 0x50, 0x15, 0x05, 0x00, 0x11, 0x45, 0x14, 0x51, 0x55, 0x01, 0x40, 0x54, 0x04, 0x10 
.byte	0x63, 0x66, 0x72, 0x37, 0x27, 0x22, 0x33, 0x67, 0x36, 0x73, 0x77, 0x23, 0x62, 0x76, 0x26, 0x32 
.byte	0xCB, 0xCE, 0xDA, 0x9F, 0x8F, 0x8A, 0x9B, 0xCF, 0x9E, 0xDB, 0xDF, 0x8B, 0xCA, 0xDE, 0x8E, 0x9A 
.byte	0x69, 0x6C, 0x78, 0x3D, 0x2D, 0x28, 0x39, 0x6D, 0x3C, 0x79, 0x7D, 0x29, 0x68, 0x7C, 0x2C, 0x38 
.byte	0xE3, 0xE6, 0xF2, 0xB7, 0xA7, 0xA2, 0xB3, 0xE7, 0xB6, 0xF3, 0xF7, 0xA3, 0xE2, 0xF6, 0xA6, 0xB2 
.byte	0xEB, 0xEE, 0xFA, 0xBF, 0xAF, 0xAA, 0xBB, 0xEF, 0xBE, 0xFB, 0xFF, 0xAB, 0xEA, 0xFE, 0xAE, 0xBA 
.byte	0x43, 0x46, 0x52, 0x17, 0x07, 0x02, 0x13, 0x47, 0x16, 0x53, 0x57, 0x03, 0x42, 0x56, 0x06, 0x12 
.byte	0xC1, 0xC4, 0xD0, 0x95, 0x85, 0x80, 0x91, 0xC5, 0x94, 0xD1, 0xD5, 0x81, 0xC0, 0xD4, 0x84, 0x90 
.byte	0xE9, 0xEC, 0xF8, 0xBD, 0xAD, 0xA8, 0xB9, 0xED, 0xBC, 0xF9, 0xFD, 0xA9, 0xE8, 0xFC, 0xAC, 0xB8 
.byte	0x49, 0x4C, 0x58, 0x1D, 0x0D, 0x08, 0x19, 0x4D, 0x1C, 0x59, 0x5D, 0x09, 0x48, 0x5C, 0x0C, 0x18 
.byte	0x61, 0x64, 0x70, 0x35, 0x25, 0x20, 0x31, 0x65, 0x34, 0x71, 0x75, 0x21, 0x60, 0x74, 0x24, 0x30

key_1:
.byte   0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0
.byte   0xc0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x80, 0x0
.byte   0x50, 0x0, 0x18, 0x0, 0x0, 0x0, 0x0, 0x1, 0x0, 0x0
.byte   0x60, 0x0, 0xa, 0x0, 0x3, 0x0, 0x0, 0x1, 0x80, 0x0
.byte   0xb0, 0x0, 0xc, 0x0, 0x1, 0x40, 0x0, 0x62, 0x0, 0x0
.byte   0x90, 0x0, 0x16, 0x0, 0x1, 0x80, 0x0, 0x2a, 0x80, 0xc
.byte   0x0, 0x1, 0x92, 0x0, 0x2, 0xc0, 0x0, 0x33, 0x0, 0x5
.byte   0xa0, 0x0, 0xa0, 0x0, 0x32, 0x40, 0x0, 0x5b, 0x80, 0x6
.byte   0xd0, 0x0, 0xd4, 0x0, 0x14, 0x0, 0x6, 0x4c, 0x0, 0xb
.byte   0x30, 0x1, 0x7a, 0x0, 0x1a, 0x80, 0x2, 0x84, 0x80, 0xc9
.byte   0xe0, 0x19, 0x26, 0x0, 0x2f, 0x40, 0x3, 0x55, 0x0, 0x50
.byte   0xf0, 0xa, 0x1c, 0x3, 0x24, 0xc0, 0x5, 0xed, 0x80, 0x6a
.byte   0x80, 0xd, 0x5e, 0x1, 0x43, 0x80, 0x64, 0x9e, 0x0, 0xbd
.byte   0x40, 0x17, 0xb0, 0x1, 0xab, 0xc0, 0x28, 0x76, 0x8c, 0x93
.byte   0x71, 0x92, 0x68, 0x2, 0xf6, 0x0, 0x35, 0x7f, 0x5, 0xe
.byte   0x10, 0xa1, 0xce, 0x32, 0x4d, 0x0, 0x5e, 0xc7, 0x86, 0xaf
.byte   0x20, 0xd5, 0xe2, 0x14, 0x39, 0xc6, 0x49, 0xa8, 0xb, 0xd8
.byte   0xc1, 0x7b, 0x4, 0x1a, 0xbc, 0x42, 0x87, 0x30, 0x49, 0x35
.byte   0xc9, 0x26, 0xb8, 0x2f, 0x60, 0x83, 0x57, 0x81, 0x50, 0xe6
.byte   0x6a, 0x1c, 0xd9, 0x24, 0xd7, 0x5, 0xec, 0x19, 0xea, 0xf0
.byte   0xbd, 0x5e, 0xd, 0x43, 0x9b, 0x24, 0x9a, 0xea, 0xbd, 0x83
.byte   0x7, 0xb0, 0x77, 0xab, 0xc1, 0xa8, 0x73, 0x6e, 0x13, 0x5d
.byte   0x42, 0x6b, 0xa0, 0xf6, 0xe, 0xf5, 0x78, 0x3e, 0xe, 0x6d
.byte   0x41, 0xcd, 0xa8, 0x4d, 0x74, 0x1e, 0xc1, 0xd5, 0x2f, 0x7
.byte   0xf5, 0xe0, 0xe8, 0x39, 0xb5, 0x9, 0xae, 0x8f, 0xd8, 0x3a
.byte   0x2b, 0x7, 0x5e, 0xbc, 0x1d, 0x7, 0x36, 0xad, 0xb5, 0xd1
.byte   0x86, 0xba, 0x25, 0x60, 0xeb, 0xd7, 0x83, 0xad, 0xe6, 0xd5
.byte   0x8c, 0xda, 0xb0, 0xd7, 0x44, 0xac, 0x1d, 0x77, 0x70, 0x75
.byte   0x1e, 0xe, 0xb1, 0x9b, 0x56, 0x1a, 0xe8, 0x9b, 0x83, 0xae
.byte   0xd0, 0x75, 0xc3, 0xc1, 0xd6, 0x33, 0x6a, 0xcd, 0xdd, 0x13
.byte   0x8b, 0xa2, 0x7a, 0xe, 0xb8, 0x78, 0x3a, 0xc9, 0x6d, 0x59
.byte   0x6d, 0xab, 0x31, 0x74, 0x4f, 0x41, 0xd7, 0x0, 0x87, 0x59

key_2:
.byte	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff 
.byte	0x2f, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x7f, 0xff 
.byte	0x1f, 0xff, 0xe5, 0xff, 0xff, 0xff, 0xff, 0xfe, 0xff, 0xff 
.byte	0x7f, 0xff, 0xe3, 0xff, 0xfc, 0xbf, 0xff, 0xfe, 0x7f, 0xff 
.byte	0x4f, 0xff, 0xef, 0xff, 0xfc, 0x7f, 0xff, 0x95, 0xff, 0xff 
.byte	0x8f, 0xff, 0xe9, 0xff, 0xfd, 0xff, 0xff, 0x8d, 0x7f, 0xf2 
.byte	0xff, 0xfe, 0x51, 0xff, 0xfd, 0x3f, 0xff, 0xbc, 0xff, 0xf1 
.byte	0xef, 0xfe, 0x3f, 0xff, 0xca, 0x3f, 0xff, 0xa4, 0x7f, 0xf7 
.byte	0x3f, 0xfe, 0xfd, 0xff, 0xc7, 0xff, 0xf9, 0x43, 0xff, 0xf4 
.byte	0xdf, 0xfe, 0x87, 0xff, 0xdf, 0xbf, 0xf8, 0xfb, 0x7f, 0x28 
.byte	0xaf, 0xe5, 0x1b, 0xff, 0xd0, 0xff, 0xfb, 0xf2, 0xff, 0x1f 
.byte	0xf, 0xe3, 0xf5, 0xfc, 0xa3, 0x7f, 0xfa, 0x1a, 0x7f, 0x7e 
.byte	0x9f, 0xef, 0xc1, 0xfc, 0x7e, 0xbf, 0x94, 0x69, 0xff, 0x43 
.byte	0xbf, 0xe8, 0x73, 0xfd, 0xf8, 0x3f, 0x8f, 0xd1, 0x72, 0x8d 
.byte	0x6e, 0x51, 0xb7, 0xfd, 0xe, 0x7f, 0xbf, 0x0, 0xf1, 0xfa 
.byte	0x5e, 0x3f, 0x4d, 0xca, 0x36, 0xff, 0xa1, 0xc8, 0x77, 0xe0 
.byte	0xce, 0xfc, 0xb, 0xc7, 0xe9, 0xb9, 0x46, 0xd7, 0xf4, 0x39 
.byte	0x2e, 0x87, 0x39, 0xdf, 0x81, 0x78, 0xfd, 0x3f, 0xa8, 0xda
.byte	0x25, 0x1b, 0x45, 0xd0, 0xe7, 0x3b, 0xf0, 0x26, 0x1f, 0xa7 
.byte	0x43, 0xf4, 0xe4, 0xa3, 0x68, 0xba, 0x1c, 0xee, 0xfe, 0x4 
.byte	0x7f, 0xc0, 0x88, 0x7e, 0x9c, 0x94, 0x6d, 0x1d, 0x43, 0x9d 
.byte	0xf8, 0x73, 0xaf, 0xf8, 0x11, 0xf, 0xd3, 0x98, 0xd, 0xa3 
.byte	0xc1, 0xb4, 0x7f, 0xe, 0x75, 0xff, 0x2, 0x2a, 0xfa, 0x73 
.byte	0xf, 0x4e, 0x78, 0x36, 0x8f, 0xe1, 0xce, 0xb4, 0x60, 0x45 
.byte	0x3c, 0x8, 0xa1, 0xe9, 0xcf, 0x6, 0xd1, 0xf0, 0x39, 0xd6 
.byte	0xc7, 0x3a, 0xc7, 0x81, 0x14, 0x3d, 0x39, 0xec, 0x5a, 0x3e 
.byte	0x3b, 0x47, 0xd8, 0xe7, 0x58, 0xf0, 0x22, 0x8a, 0xa7, 0x3d 
.byte	0x4, 0xe7, 0xa7, 0x68, 0xfb, 0x1c, 0xeb, 0x13, 0x84, 0x51 
.byte	0xd0, 0x8a, 0x20, 0x9c, 0xf4, 0xed, 0x1f, 0x6d, 0x9d, 0x62 
.byte	0x83, 0xac, 0x5a, 0x11, 0x44, 0x13, 0x9e, 0x93, 0x23, 0xed 
.byte	0xa4, 0x7d, 0xb0, 0x75, 0x8b, 0x42, 0x28, 0x8d, 0x73, 0xd2 
.byte   0xfe, 0x7a, 0x54, 0x8f, 0xb6, 0xe, 0xb1, 0x67, 0xc5, 0x11

.text

// initalize round counter i = 1 to hex(32) = 1f
li x6, 0x1
li x7, 0x1f


// load plaintext/state (64 bits)
//  Plaintext input for TC - 1, 2
/*
li x18, 0x0
li x19, 0x0
li x20, 0x0
li x21, 0x0
li x22, 0x0
li x23, 0x0
li x24, 0x0
li x25, 0x0
*/

// Plaintext input for TC - 3, 4
li x18, 0xff
li x19, 0xff
li x20, 0xff
li x21, 0xff
li x22, 0xff
li x23, 0xff
li x24, 0xff
li x25, 0xff


// intialize key table pointer

// Key Input for TC1, TC3
la  x8, key_1

// Key input for TC2, TC4
// la  x8, key_2

for_loop:

// get key (64 bits) from memory
// STORAGE: States - x10-17, Cipher - x18-x25

// add_key

addi x4, x8, 0
lbu  x5, (x4)
xor x10, x18, x5

addi x4, x8, 1
lbu  x5, (x4)
xor x11, x19, x5

addi x4, x8, 2
lbu  x5, (x4)
xor x12, x20, x5

addi x4, x8, 3
lbu  x5, (x4)
xor x13, x21, x5

addi x4, x8, 4
lbu  x5, (x4)
xor x14, x22, x5

addi x4, x8, 5
lbu  x5, (x4)
xor x15, x23, x5

addi x4, x8, 6
lbu  x5, (x4)
xor x16, x24, x5

addi x4, x8, 7
lbu  x5, (x4)
xor x17, x25, x5

// SP Layer

// intialize SP LUT pointers
la x2, sp_0
la x3, sp_1
la x4, sp_2
la x5, sp_3

// cipher[0]
add x29, x5, x10
lbu x18, (x29)
andi x18, x18, 0xC0

add x29, x4, x11
lbu x30, (x29)
andi x30, x30, 0x30
or x18, x18, x30

add x29, x3, x12
lbu x30, (x29)
andi x30, x30, 0x0C
or x18, x18, x30

add x29, x2, x13
lbu x30, (x29)
andi x30, x30, 0x03
or x18, x18, x30

//cipher[1]
add x29, x5, x14
lbu x19, (x29)
andi x19, x19, 0xC0

add x29, x4, x15
lbu x30, (x29)
andi x30, x30, 0x30
or x19, x19, x30

add x29, x3, x16
lbu x30, (x29)
andi x30, x30, 0x0C
or x19, x19, x30

add x29, x2, x17
lbu x30, (x29)
andi x30, x30, 0x03
or x19, x19, x30

// cipher[2]
add x29, x2, x10
lbu x20, (x29)
andi x20, x20, 0xC0

add x29, x5, x11
lbu x30, (x29)
andi x30, x30, 0x30
or x20, x20, x30

add x29, x4, x12
lbu x30, (x29)
andi x30, x30, 0x0C
or x20, x20, x30

add x29, x3, x13
lbu x30, (x29)
andi x30, x30, 0x03
or x20, x20, x30

//cipher[3]
add x29, x2, x14
lbu x21, (x29)
andi x21, x21, 0xC0

add x29, x5, x15
lbu x30, (x29)
andi x30, x30, 0x30
or x21, x21, x30

add x29, x4, x16
lbu x30, (x29)
andi x30, x30, 0x0C
or x21, x21, x30

add x29, x3, x17
lbu x30, (x29)
andi x30, x30, 0x03
or x21, x21, x30

// cipher[4]
add x29, x3, x10
lbu x22, (x29)
andi x22, x22, 0xC0

add x29, x2, x11
lbu x30, (x29)
andi x30, x30, 0x30
or x22, x22, x30

add x29, x5, x12
lbu x30, (x29)
andi x30, x30, 0x0C
or x22, x22, x30

add x29, x4, x13
lbu x30, (x29)
andi x30, x30, 0x03
or x22, x22, x30

// cipher[5]
add x29, x3, x14
lbu x23, (x29)
andi x23, x23, 0xC0

add x29, x2, x15
lbu x30, (x29)
andi x30, x30, 0x30
or x23, x23, x30

add x29, x5, x16
lbu x30, (x29)
andi x30, x30, 0x0C
or x23, x23, x30

add x29, x4, x17
lbu x30, (x29)
andi x30, x30, 0x03
or x23, x23, x30

// cipher[6]
add x29, x4, x10
lbu x24, (x29)
andi x24, x24, 0xC0

add x29, x3, x11
lbu x30, (x29)
andi x30, x30, 0x30
or x24, x24, x30

add x29, x2, x12
lbu x30, (x29)
andi x30, x30, 0x0C
or x24, x24, x30

add x29, x5, x13
lbu x30, (x29)
andi x30, x30, 0x03
or x24, x24, x30

//cipher[7]
add x29, x4, x14
lbu x25, (x29)
andi x25, x25, 0xC0

add x29, x3, x15
lbu x30, (x29)
andi x30, x30, 0x30
or x25, x25, x30

add x29, x2, x16
lbu x30, (x29)
andi x30, x30, 0x0C
or x25, x25, x30

add x29, x5, x17
lbu x30, (x29)
andi x30, x30, 0x03
or x25, x25, x30

// increment the row in key table for the next round
addi x8, x8, 10

beq x6, x7, done

// increment round counter
addi x6, x6, 1

// for loop body ends

j for_loop;

done:
//final XOR between key and cipher

addi x4, x8, 0
lbu  x5, (x4)
xor x18, x18, x5

addi x4, x8, 1
lbu  x5, (x4)
xor x19, x19, x5

addi x4, x8, 2
lbu  x5, (x4)
xor x20, x20, x5

addi x4, x8, 3
lbu  x5, (x4)
xor x21, x21, x5

addi x4, x8, 4
lbu  x5, (x4)
xor x22, x22, x5

addi x4, x8, 5
lbu  x5, (x4)
xor x23, x23, x5

addi x4, x8, 6
lbu  x5, (x4)
xor x24, x24, x5

addi x4, x8, 7
lbu  x5, (x4)
xor x25, x25, x5


ret;

